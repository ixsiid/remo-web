(function(e){function t(t){for(var c,r,i=t[0],u=t[1],s=t[2],p=0,b=[];p<i.length;p++)r=i[p],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&b.push(a[r][0]),a[r]=0;for(c in u)Object.prototype.hasOwnProperty.call(u,c)&&(e[c]=u[c]);l&&l(t);while(b.length)b.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],c=!0,i=1;i<n.length;i++){var u=n[i];0!==a[u]&&(c=!1)}c&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var c={},a={app:0},o=[];function r(t){if(c[t])return c[t].exports;var n=c[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=c,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)r.d(n,c,function(t){return e[t]}.bind(null,c));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var l=u;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"07b6":function(e,t,n){"use strict";n("1b1d")},"1b1d":function(e,t,n){},"1c0b7":function(e,t,n){"use strict";n("c989")},3369:function(e,t,n){},"3b72":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var c=n("b85c"),a=n("d4ec"),o=n("bee2"),r=n("ade3"),i=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("d3b7"),n("4de4"),n("ddb0"),n("99af"),n("3ca3"),n("d81d"),n("7a23"));function u(e,t,n,c,a,o){var r=Object(i["j"])("Auth");return Object(i["f"])(),Object(i["c"])(r,{auth_key:""})}var s=Object(i["n"])("data-v-3acc0ade");Object(i["h"])("data-v-3acc0ade");var l={key:0},p={key:1},b={class:"devices"};Object(i["g"])();var f=s((function(e,t,n,c,a,o){var r=Object(i["j"])("User"),u=Object(i["j"])("Device");return Object(i["f"])(),Object(i["c"])(i["a"],null,[a.authorized?(Object(i["f"])(),Object(i["c"])("div",l,[Object(i["e"])(r,{user:e.user},null,8,["user"])])):(Object(i["f"])(),Object(i["c"])("div",p,[Object(i["m"])(Object(i["e"])("input",{type:"text",placeholder:"Enter OAuth key","onUpdate:modelValue":t[1]||(t[1]=function(e){return o._key=e}),disabled:a.authorizing},null,8,["disabled"]),[[i["l"],o._key]]),Object(i["e"])("input",{type:"button",value:"認証",onClick:t[2]||(t[2]=function(e){return o.process_authorize(o._key)}),disabled:a.authorizing},null,8,["disabled"])])),Object(i["e"])("ul",b,[(Object(i["f"])(!0),Object(i["c"])(i["a"],null,Object(i["i"])(a.devices,(function(e){return Object(i["f"])(),Object(i["c"])("li",{key:e.id},[Object(i["e"])(u,{device:e,appliances:a.appliances.filter((function(t){return t.device.id==e.id}))},null,8,["device","appliances"])])})),128))])],64)})),d=n("3835"),h=Object(i["n"])("data-v-3ffebda9"),j=h((function(e,t,n,c,a,o){return Object(i["f"])(),Object(i["c"])("p",null,"ようこそ、"+Object(i["k"])(n.user.nickname),1)})),O={name:"User",props:{user:{type:Object}}};O.render=j,O.__scopeId="data-v-3ffebda9";var v=O,g=(n("b0c0"),n("b64b"),Object(i["n"])("data-v-a6c4b8e6"));Object(i["h"])("data-v-a6c4b8e6");var y={class:"device"},m={class:"sensors"},k={class:"appliances"};Object(i["g"])();var _=g((function(e,t,n,c,a,o){var r=Object(i["j"])("Appliance");return Object(i["f"])(),Object(i["c"])(i["a"],null,[Object(i["e"])("div",y,[Object(i["e"])("p",null,Object(i["k"])(n.device.name),1),Object(i["e"])("ul",m,[(Object(i["f"])(!0),Object(i["c"])(i["a"],null,Object(i["i"])(Object.keys(n.device.newest_events),(function(e){return Object(i["f"])(),Object(i["c"])("li",{key:e},Object(i["k"])({te:"気温",hu:"湿度",il:"明るさ",mo:"人感"}[e])+" : "+Object(i["k"])(n.device.newest_events[e].val)+" "+Object(i["k"])({te:"℃",hu:"%",il:"",mo:""}[e]),1)})),128))])]),Object(i["e"])("ul",k,[(Object(i["f"])(!0),Object(i["c"])(i["a"],null,Object(i["i"])(n.appliances,(function(e){return Object(i["f"])(),Object(i["c"])("li",{key:e.id},[Object(i["e"])(r,{appliance:e},null,8,["appliance"])])})),128))])],64)})),w=Object(i["n"])("data-v-610d97bc");Object(i["h"])("data-v-610d97bc");var P={class:"appliance"},A={class:"signals"};Object(i["g"])();var z=w((function(e,t,n,c,a,o){var r=Object(i["j"])("Signal");return Object(i["f"])(),Object(i["c"])("div",P,[Object(i["e"])("p",null,[Object(i["d"])(Object(i["k"])(n.appliance.nickname)+" ",1),Object(i["e"])("button",{onClick:t[1]||(t[1]=function(){return e.log&&e.log.apply(e,arguments)})},"log")]),Object(i["e"])("ul",A,[(Object(i["f"])(!0),Object(i["c"])(i["a"],null,Object(i["i"])(a.signals,(function(e){return Object(i["f"])(),Object(i["c"])("li",{key:e.id},[Object(i["e"])(r,{signal:e},null,8,["signal"])])})),128))])])})),S=Object(i["n"])("data-v-52f5e17f");Object(i["h"])("data-v-52f5e17f");var T={class:"signal"};Object(i["g"])();var D=S((function(e,t,n,c,a,o){return Object(i["f"])(),Object(i["c"])("div",T,[Object(i["e"])("button",{onClick:t[1]||(t[1]=function(){return o.send&&o.send.apply(o,arguments)})},Object(i["k"])(n.signal.image),1),Object(i["e"])("p",null,Object(i["k"])(n.signal.name),1)])})),x={name:"Signal",props:{signal:{type:Object}},methods:{send:function(){this.nature.post("/1/signals/".concat(this.signal.id,"/send")).then((function(e){return console.log(e)})).catch((function(e){return console.error(e)}))}}};n("a7ee");x.render=D,x.__scopeId="data-v-52f5e17f";var I=x,M={name:"Appliance",components:{Signal:I},props:{appliance:{type:Object,required:!0}},data:function(){return{signals:[]}},mounted:function(){var e=this;this.appliance&&this.nature.get("/1/appliances/".concat(this.appliance.id,"/signals")).then((function(t){return e.signals=t}))}};n("07b6");M.render=z,M.__scopeId="data-v-610d97bc";var U=M,B={name:"Device",components:{Appliance:U},props:{device:{type:Object},appliances:{type:Array}},methods:{log:function(){console.log(this.device),console.log(this.appliances)}}};n("672c");B.render=_,B.__scopeId="data-v-a6c4b8e6";var C=B,J={name:"Auth",components:{User:v,Device:C},props:{auth_key:{type:String}},data:function(){return{authorized:!1,authorizing:!1,token:"",nickname:"",devices:[],appliances:[]}},computed:{_key:{get:function(){return this.auth_key},set:function(e){this.$emit("change",e)}}},mounted:function(){console.log("mounted: ".concat(new Date)),console.log(this.nature),this.auth_key&&this.process_authorize(this.auth_key)},methods:{error:function(e){console.log(e)},process_authorize:function(e){var t=this;this.authorizing=!0,this.nature.token=e,this.nature.get("/1/users/me").finally((function(){return t.authorizing=!1})).then((function(n){console.log(n),n.nickname&&(t.authorized=!0,t.token=e,t.user=n,t.get_devices())})).catch((function(e){t.authorized=!1,console.error(e)}))},get_devices:function(){var e=this;this.nature.get(["/1/devices","/1/appliances"]).then((function(t){var n=Object(d["a"])(t,2),c=n[0],a=n[1];e.devices=c,e.appliances=a})).catch((function(t){return e.error(t)}))}}};n("1c0b7");J.render=f,J.__scopeId="data-v-3acc0ade";var N=J,q={name:"App",components:{Auth:N}};n("5cec");q.render=u;var E=q,V=function(){function e(){Object(a["a"])(this,e),Object(r["a"])(this,"token",void 0),this.token="",this.call=[]}return Object(o["a"])(e,[{key:"get",value:function(e){var t=this;if(!this.token)return new Promise((function(e,t){return t("No token")}));var n=(new Date).getTime();return this.call=this.call.filter((function(e){return e>n-1e3*n*60*5})),this.call.length>25?new Promise((function(e,t){return t("Too many call api")})):"string"===typeof e?(this.call.push((new Date).getTime()),new Promise((function(n,a){fetch("https://api.nature.global".concat(e),{headers:{Accept:"application/json",Authorization:"Bearer ".concat(t.token)}}).then((function(e){console.log("---------------"),console.log(e.status),200!=e.status&&a(e.json());var t,n=Object(c["a"])(e.headers.keys());try{for(n.s();!(t=n.n()).done;){var o=t.value;console.log("".concat(o,": ").concat(e.headers.get(o)))}}catch(r){n.e(r)}finally{n.f()}return e.json()})).then(n).catch(a)}))):new Promise(e instanceof Array?function(n,c){Promise.all(e.map((function(e){return t.call.push((new Date).getTime()),fetch("https://api.nature.global".concat(e),{headers:{Accept:"application/json",Authorization:"Bearer ".concat(t.token)}}).then((function(e){return e.json()}))}))).then(n).catch(c)}:function(t,n){return n("Invalid arguments ".concat(e))})}},{key:"post",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"{}";if(!this.token)return new Promise((function(e,t){return t("No token")}));var a=(new Date).getTime();return this.call=this.call.filter((function(e){return e>a-1e3*a*60*5})),this.call.length>25?new Promise((function(e,t){return t("Too many call api")})):(this.call.push((new Date).getTime()),new Promise((function(a,o){fetch("https://api.nature.global".concat(e),{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t.token)},body:n}).then((function(e){console.log("---------------"),console.log(e.status),200!=e.status&&o(e.json());var t,n=Object(c["a"])(e.headers.keys());try{for(n.s();!(t=n.n()).done;){var a=t.value;console.log("".concat(a,": ").concat(e.headers.get(a)))}}catch(r){n.e(r)}finally{n.f()}return e.json()})).then(a).catch(o)})))}}]),e}(),$=Object(i["b"])(E);$.config.globalProperties.nature=new V,$.mount("#app")},"5cec":function(e,t,n){"use strict";n("d39d")},"672c":function(e,t,n){"use strict";n("3b72")},a7ee:function(e,t,n){"use strict";n("3369")},c989:function(e,t,n){},d39d:function(e,t,n){}});
//# sourceMappingURL=app.6192c76f.js.map